import pandas as pd
import numpy as np
from Utils.MatrixBuilder import Utils
from Utils.Evaluation import Eval


class Recommender(object):

    def __init__(self):
        self.train = pd.read_csv("data/train.csv")
        self.tracks = pd.read_csv("data/tracks.csv")
        self.target_playlists = pd.read_csv("data/target_playlists.csv")
        self.train_sequential = pd.read_csv("data/train_sequential.csv")

        # Load URMs for category 1 (5000 sequential)
        self.u_1 = Utils(self.train, self.tracks, self.target_playlists, self.train_sequential)
        self.e_1 = Eval(self.u, (np.random.choice(range(10000), 5000, replace=False)).tolist())
        self.URM_full_1 = self.u.get_URM()
        self.URM_train_1 = self.e.get_URM_train()

        # Load URMs for category 2 (5000 random)
        self.u_1 = Utils(self.train, self.tracks, self.target_playlists, self.train_sequential)
        self.e_1 = Eval(self.u, (np.random.choice(range(10000), 5000, replace=False)).tolist())
        self.URM_full_1 = self.u.get_URM()
        self.URM_train_1 = self.e.get_URM_train()